{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import axios from'axios';import styles from'./styles.module.css';import ReviewSubmission from'../ReviewSubmission';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const base_url=process.env.REACT_APP_API_URL;const AudiobookDetail=()=>{const{id}=useParams();const[detailData,setDetailData]=useState(null);const[averageRating,setAverageRating]=useState(0);useEffect(()=>{const getDetailData=async()=>{try{const url=\"\".concat(base_url,\"/\").concat(id);const{data}=await axios.get(url);setDetailData(data.audiobook);if(data.reviews.length){const totalRatings=data.reviews.reduce((acc,review)=>acc+review.rating,0);setAverageRating(totalRatings/data.reviews.length);}}catch(err){console.error(\"Failed to fetch audiobook details:\",err);}};getDetailData();},[id]);const handleReviewSubmitted=reviewData=>{setDetailData(prevData=>{const updatedReviews=[...prevData.reviews,reviewData];const totalRatings=updatedReviews.reduce((acc,review)=>acc+review.rating,0);setAverageRating(totalRatings/updatedReviews.length);return{...prevData,reviews:updatedReviews};});};if(!detailData){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:styles.detailPage,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.audiobookDetail,children:[/*#__PURE__*/_jsx(\"img\",{src:detailData.img,alt:detailData.title,className:styles.audiobookImg}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:detailData.title}),/*#__PURE__*/_jsx(\"h2\",{children:detailData.author}),/*#__PURE__*/_jsx(\"p\",{children:detailData.description}),/*#__PURE__*/_jsx(\"div\",{className:styles.audiobookGenres,children:detailData.genre.map((genre,index)=>/*#__PURE__*/_jsx(\"span\",{className:styles.audiobookGenre,children:genre},genre))}),/*#__PURE__*/_jsxs(\"div\",{className:styles.audiobookRating,children:[[1,2,3,4,5].map(star=>/*#__PURE__*/_jsx(\"span\",{className:styles.star,children:star<=averageRating?'★':'☆'},star)),/*#__PURE__*/_jsx(\"span\",{children:averageRating.toFixed(1)})]})]})]}),/*#__PURE__*/_jsx(ReviewSubmission,{audiobookId:id,onReviewSubmitted:handleReviewSubmitted})]});};export default AudiobookDetail;","map":{"version":3,"names":["React","useEffect","useState","useParams","axios","styles","ReviewSubmission","jsx","_jsx","jsxs","_jsxs","base_url","process","env","REACT_APP_API_URL","AudiobookDetail","id","detailData","setDetailData","averageRating","setAverageRating","getDetailData","url","concat","data","get","audiobook","reviews","length","totalRatings","reduce","acc","review","rating","err","console","error","handleReviewSubmitted","reviewData","prevData","updatedReviews","children","className","detailPage","audiobookDetail","src","img","alt","title","audiobookImg","author","description","audiobookGenres","genre","map","index","audiobookGenre","audiobookRating","star","toFixed","audiobookId","onReviewSubmitted"],"sources":["C:/Users/dell/audiobook-rating/client/src/components/AudiobookDetail/index.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport styles from './styles.module.css';\r\nimport ReviewSubmission from '../ReviewSubmission';\r\n\r\nconst base_url = process.env.REACT_APP_API_URL;\r\n\r\nconst AudiobookDetail = () => {\r\n    const { id } = useParams();\r\n    const [detailData, setDetailData] = useState(null);\r\n    const [averageRating, setAverageRating] = useState(0);\r\n\r\n    useEffect(() => {\r\n        const getDetailData = async () => {\r\n            try {\r\n                const url = `${base_url}/${id}`;\r\n                const { data } = await axios.get(url);\r\n                setDetailData(data.audiobook);\r\n                if (data.reviews.length) {\r\n                    const totalRatings = data.reviews.reduce((acc, review) => acc + review.rating, 0);\r\n                    setAverageRating(totalRatings / data.reviews.length);\r\n                }\r\n            } catch (err) {\r\n                console.error(\"Failed to fetch audiobook details:\", err);\r\n            }\r\n        };\r\n\r\n        getDetailData();\r\n    }, [id]);\r\n\r\n    const handleReviewSubmitted = (reviewData) => {\r\n        setDetailData(prevData => {\r\n            const updatedReviews = [...prevData.reviews, reviewData];\r\n            const totalRatings = updatedReviews.reduce((acc, review) => acc + review.rating, 0);\r\n            setAverageRating(totalRatings / updatedReviews.length);\r\n            return {\r\n                ...prevData,\r\n                reviews: updatedReviews,\r\n            };\r\n        });\r\n    };\r\n\r\n    if (!detailData) {\r\n        return <div>Loading...</div>;\r\n    }\r\n\r\n    return (\r\n        <div className={styles.detailPage}>\r\n            <div className={styles.audiobookDetail}>\r\n                <img src={detailData.img} alt={detailData.title} className={styles.audiobookImg} />\r\n                <div>\r\n                    <h1>{detailData.title}</h1>\r\n                    <h2>{detailData.author}</h2>\r\n                    <p>{detailData.description}</p>\r\n                    <div className={styles.audiobookGenres}>\r\n                        {detailData.genre.map((genre, index) => (\r\n                            <span key={genre} className={styles.audiobookGenre}>{genre}</span>\r\n                        ))}\r\n                    </div>\r\n                    <div className={styles.audiobookRating}>\r\n                        {[1, 2, 3, 4, 5].map(star => (\r\n                            <span key={star} className={styles.star}>\r\n                                {star <= averageRating ? '★' : '☆'}\r\n                            </span>\r\n                        ))}\r\n                        <span>{averageRating.toFixed(1)}</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <ReviewSubmission audiobookId={id} onReviewSubmitted={handleReviewSubmitted} />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AudiobookDetail;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,MAAO,CAAAC,gBAAgB,KAAM,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnD,KAAM,CAAAC,QAAQ,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,CAE9C,KAAM,CAAAC,eAAe,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAAEC,EAAG,CAAC,CAAGb,SAAS,CAAC,CAAC,CAC1B,KAAM,CAACc,UAAU,CAAEC,aAAa,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CAClD,KAAM,CAACiB,aAAa,CAAEC,gBAAgB,CAAC,CAAGlB,QAAQ,CAAC,CAAC,CAAC,CAErDD,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAoB,aAAa,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACA,KAAM,CAAAC,GAAG,IAAAC,MAAA,CAAMZ,QAAQ,MAAAY,MAAA,CAAIP,EAAE,CAAE,CAC/B,KAAM,CAAEQ,IAAK,CAAC,CAAG,KAAM,CAAApB,KAAK,CAACqB,GAAG,CAACH,GAAG,CAAC,CACrCJ,aAAa,CAACM,IAAI,CAACE,SAAS,CAAC,CAC7B,GAAIF,IAAI,CAACG,OAAO,CAACC,MAAM,CAAE,CACrB,KAAM,CAAAC,YAAY,CAAGL,IAAI,CAACG,OAAO,CAACG,MAAM,CAAC,CAACC,GAAG,CAAEC,MAAM,GAAKD,GAAG,CAAGC,MAAM,CAACC,MAAM,CAAE,CAAC,CAAC,CACjFb,gBAAgB,CAACS,YAAY,CAAGL,IAAI,CAACG,OAAO,CAACC,MAAM,CAAC,CACxD,CACJ,CAAE,MAAOM,GAAG,CAAE,CACVC,OAAO,CAACC,KAAK,CAAC,oCAAoC,CAAEF,GAAG,CAAC,CAC5D,CACJ,CAAC,CAEDb,aAAa,CAAC,CAAC,CACnB,CAAC,CAAE,CAACL,EAAE,CAAC,CAAC,CAER,KAAM,CAAAqB,qBAAqB,CAAIC,UAAU,EAAK,CAC1CpB,aAAa,CAACqB,QAAQ,EAAI,CACtB,KAAM,CAAAC,cAAc,CAAG,CAAC,GAAGD,QAAQ,CAACZ,OAAO,CAAEW,UAAU,CAAC,CACxD,KAAM,CAAAT,YAAY,CAAGW,cAAc,CAACV,MAAM,CAAC,CAACC,GAAG,CAAEC,MAAM,GAAKD,GAAG,CAAGC,MAAM,CAACC,MAAM,CAAE,CAAC,CAAC,CACnFb,gBAAgB,CAACS,YAAY,CAAGW,cAAc,CAACZ,MAAM,CAAC,CACtD,MAAO,CACH,GAAGW,QAAQ,CACXZ,OAAO,CAAEa,cACb,CAAC,CACL,CAAC,CAAC,CACN,CAAC,CAED,GAAI,CAACvB,UAAU,CAAE,CACb,mBAAOT,IAAA,QAAAiC,QAAA,CAAK,YAAU,CAAK,CAAC,CAChC,CAEA,mBACI/B,KAAA,QAAKgC,SAAS,CAAErC,MAAM,CAACsC,UAAW,CAAAF,QAAA,eAC9B/B,KAAA,QAAKgC,SAAS,CAAErC,MAAM,CAACuC,eAAgB,CAAAH,QAAA,eACnCjC,IAAA,QAAKqC,GAAG,CAAE5B,UAAU,CAAC6B,GAAI,CAACC,GAAG,CAAE9B,UAAU,CAAC+B,KAAM,CAACN,SAAS,CAAErC,MAAM,CAAC4C,YAAa,CAAE,CAAC,cACnFvC,KAAA,QAAA+B,QAAA,eACIjC,IAAA,OAAAiC,QAAA,CAAKxB,UAAU,CAAC+B,KAAK,CAAK,CAAC,cAC3BxC,IAAA,OAAAiC,QAAA,CAAKxB,UAAU,CAACiC,MAAM,CAAK,CAAC,cAC5B1C,IAAA,MAAAiC,QAAA,CAAIxB,UAAU,CAACkC,WAAW,CAAI,CAAC,cAC/B3C,IAAA,QAAKkC,SAAS,CAAErC,MAAM,CAAC+C,eAAgB,CAAAX,QAAA,CAClCxB,UAAU,CAACoC,KAAK,CAACC,GAAG,CAAC,CAACD,KAAK,CAAEE,KAAK,gBAC/B/C,IAAA,SAAkBkC,SAAS,CAAErC,MAAM,CAACmD,cAAe,CAAAf,QAAA,CAAEY,KAAK,EAA/CA,KAAsD,CACpE,CAAC,CACD,CAAC,cACN3C,KAAA,QAAKgC,SAAS,CAAErC,MAAM,CAACoD,eAAgB,CAAAhB,QAAA,EAClC,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAE,CAAC,CAAC,CAACa,GAAG,CAACI,IAAI,eACrBlD,IAAA,SAAiBkC,SAAS,CAAErC,MAAM,CAACqD,IAAK,CAAAjB,QAAA,CACnCiB,IAAI,EAAIvC,aAAa,CAAG,GAAG,CAAG,GAAG,EAD3BuC,IAEL,CACT,CAAC,cACFlD,IAAA,SAAAiC,QAAA,CAAOtB,aAAa,CAACwC,OAAO,CAAC,CAAC,CAAC,CAAO,CAAC,EACtC,CAAC,EACL,CAAC,EACL,CAAC,cACNnD,IAAA,CAACF,gBAAgB,EAACsD,WAAW,CAAE5C,EAAG,CAAC6C,iBAAiB,CAAExB,qBAAsB,CAAE,CAAC,EAC9E,CAAC,CAEd,CAAC,CAED,cAAe,CAAAtB,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}